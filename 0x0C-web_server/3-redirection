#!/usr/bin/env bash
# Installs nginx on web server
# and set /redirect_me to another page

# update package lists for upgrades
sudo apt-get update

# Install nginx
sudo apt-get install -y nginx

# start Nginx
sudo service nginx start

# create a simple html file
echo "Hello World!" > /var/www/html/index.html

# replace a line with multiple line using sed
sed -i 's/Hello World!/This is the first new line\nSecond replacement line\nThird replacement line/g' /var/www/html/index.html

# configure nginx to redirect /redirect_me to another page
echo 'server {
    listen 80;
    server_name localhost;

    location = /redirect_me {
        return 301 http://taurai.tech/google.com
    }
}' | sudo tee /etc/nginx/sites-available/default

# restart nginx
sudo service nginx restart
