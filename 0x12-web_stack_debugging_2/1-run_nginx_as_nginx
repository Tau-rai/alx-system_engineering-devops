#!/usr/bin/env bash
# This script configures a container to run nginx as ngix user
# and listens to all active IPs on port 8080

# Function to configure Nginx
configure_nginx() {
    # Change the user in the Nginx configuration
    sed -i 's/user root;/user nginx;/g' /etc/nginx/nginx.conf

    # Change the listen directive to listen on port 8080
    sed -i 's/listen 80;/listen 8080;/g' /etc/nginx/sites-available/default
}

# Main function
main() {
    # Configure Nginx
    configure_nginx

    # Restart Nginx to apply the changes
    service nginx restart

    echo "Nginx has been successfully configured and restarted"
}

# Execute the main function
main
